{% extends "layouts/default.html" %}
{% set title = _("Results for %(tag)s", tag=tag_info.tag) %}

{% from "components/artwork-entry.html" import entry %}
{% from "components/paginator.html" import paginator %}

{% block content %}
<section id="search-info">
    <div class="banner-wrapper">
        <img src="{{tag_info.pixpedia.image}}" alt="">
        <div class="backdrop-wrapper"></div>
    </div>
    <main>
        <div class="wrapper">
            {% if tag_info.pixpedia.image %}
            <img src="{{tag_info.pixpedia.image}}" alt="{{tag_info.tag}}">
            {% endif %}
            <article>
                {% if tag_info.translation and tag_info.translation.default != tag_info.tag %}
                <h2>#{{tag_info.tag}} <small>{{ tag_info.translation.default }}</small></h2>
                {% else %}
                <h2>#{{tag_info.tag}}</h2>
                {% endif %}
                <p class="work-count">{{_("<b>%(total)s</b> Works", total=data.total|numberformat)}}</p>
                {% if tag_info.pixpedia.abstract %}
                <p class="abstract">{{tag_info.pixpedia.abstract}}</p>
                {% endif %}
            </article>
            {% if g.authorized %}

            {%- if tag_info.is_favorite %}
            {% set action="remove_favorite_tag"%}
            {% else %}
            {% set action="add_favorite_tag"%}
            {% endif -%}

            <form id="favorites-action" action="/self/action/{{action}}" method="post" hx-push-url="false"
                hx-swap="outerHTML show:none" hx-target="this" hx-headers='{"X-Vixipy-Quick-Action": "true"}'>

                <input type="hidden" name="tag" value="{{tag_info.tag}}">
                <input type="hidden" name="return_to" value="{{request.path}}">

                {%- if not tag_info.is_favorite %}
                <button type="submit" class="button primary" {%- if tag_info.favorite_tags|length==10%} disabled
                    title="{{_('You can only have at most 10 favorite tags. Please remove one and try again.')}}" {%
                    endif -%}>{{_("Add to your favorites")}}</button>
                {% else %}
                <button type="submit" class="button neutral">{{_("Remove from favorites")}}</button>
                {% endif -%}

            </form>

            {% endif %}
        </div>
    </main>
</section>
<main class="large">
    {% block body %}{% endblock %}
</main>
{% endblock %}