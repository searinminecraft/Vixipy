{% extends "layouts/default.html" %}
{% block title %}{{ data.artwork.title }}{% endblock %}

{% block additionalHeadData %}
<meta property="og:title" content="{{ data.artwork.title }}">
<meta property="og:site_name" content="PyXiv">
<meta property="og:type" content="article">
<meta property="og:description" content="{{ data.artwork.title }} by {{ data.user.name }} -- {{ data.artwork.viewCount}} views, {{ data.artwork.likeCount}} likes, {{ data.artwork.bookmarkCount }} bookmarks">
<meta property="og:image" content="https://embed.pixiv.net/artwork.php?illust_id={{ data.artwork._id }}">
<meta property="og:url" content="/artworks/{{ data.artwork._id }}">
<meta content="summary_large_image" name="twitter:card" />
{% endblock %}

{% block content %}
<div class="illust-area">
	{% if data.artwork.isUgoira %}
	<div class="illusts">
		<div class="illust">
			<video class="ugoira" autoplay muted loop disablepictureinpicture playsinline poster="{{ data.pages[0].thumbUrl }}" src="/proxy/ugoira/{{ data.artwork._id }}">
		</div>
	</div>
	<br>
	<a href="/proxy/ugoira/{{ data.artwork._id }}">Download</a>
	<a href="https://ugoira.com/i/{{ data.artwork._id }}">Go to ugoira.com for more options like GIF conversion.</a>
	{% else %}
	<div class="illusts">
		{% if data.artwork.pageCount > 1 %}
		{% for x in data.pages %}
		<div class="illust">
			<a href="{{ x.originalUrl }}">
				<img src="{{ x.thumbUrl }}" />
			</a>
		</div>
		{% endfor %}
		{% else %}
		<div class="illust">
			<a href="{{ data.artwork.originalUrl }}">
				<img src="{{ data.artwork.thumbUrl }}" />
			</a>
		</div>
		{% endif %}
	</div>
	{% endif %}

	<br>
	<div class="illust-title">
		<span>{{ data.artwork.title }}</span>
		{% if g.isAuthorized %}
		<div class="illust-actions">
			{% if data.artwork.commentOff == false %}
				<a href="/artworks/{{ data.artwork._id }}/comments">
					<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M280-240q-17 0-28.5-11.5T240-280v-80h520v-360h80q17 0 28.5 11.5T880-680v600L720-240H280ZM80-280v-560q0-17 11.5-28.5T120-880h520q17 0 28.5 11.5T680-840v360q0 17-11.5 28.5T640-440H240L80-280Z"/></svg>
					<span>{{ data.artwork.commentCount}}</span>
				</a>
			{% endif %}
			{% if data.artwork.bookmarked %}
				<a href="/self/removebookmark/{{ data.artwork.bookmarkId }}?r=/artworks/{{ data.artwork._id }}">
					<img src={{"/static/icons/bookmarked.svg"}}/>
					<span>{{ data.artwork.bookmarkCount }}</span>
				</a>
			{% else %}
				<a href="/self/addbookmark/{{ data.artwork._id }}?r=/artworks/{{ data.artwork._id }}">
					<img src="/static/icons/bookmark.svg"/>
					<span>{{ data.artwork.bookmarkCount }}</span>
				</a>
			{% endif %}

			{% if data.artwork.liked %}
				<a href="#" onclick="cannotUnlike()">
					<img src="/static/icons/liked.svg"/>
					<span>{{ data.artwork.likeCount }}</span>
				</a>
			{% else %}
				<a href="/self/like/{{ data.artwork._id }}?r=/artworks/{{ data.artwork._id }}">
					<img src="/static/icons/like.svg"/>
					<span>{{ data.artwork.likeCount }}</span>
				</a>
			{% endif %}
		</div>
		{% else %}
		<div class="illust-actions">
			{% if data.artwork.commentOff == false %}
				<a href="/artworks/{{ data.artwork._id }}/comments">
					<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M280-240q-17 0-28.5-11.5T240-280v-80h520v-360h80q17 0 28.5 11.5T880-680v600L720-240H280ZM80-280v-560q0-17 11.5-28.5T120-880h520q17 0 28.5 11.5T680-840v360q0 17-11.5 28.5T640-440H240L80-280Z"/></svg>
					<span>{{ data.artwork.commentCount}}</span>
				</a>
			{% endif %}

				<a href="/self/addbookmark/{{ data.artwork._id }}?r=/artworks/{{ data.artwork._id }}">
					<img src="/static/icons/bookmark.svg"/>
					<span>{{ data.artwork.bookmarkCount }}</span>
				</a>
				<a href="/self/like/{{ data.artwork._id }}?r=/artworks/{{ data.artwork._id }}">
					<img src="/static/icons/like.svg"/>
					<span>{{ data.artwork.likeCount }}</span>
				</a>
		</div>

		{% endif %}
	</div>
	<div class="illust-metadata">
		{% if data.artwork.isAI %}
		<span>AI Generated</span>
		{% endif %}
		{% if data.artwork.xRestrict != 0 %}
		<span>{{ data.artwork.xRestrictClassification }}</span>
		{% endif %}
		<span>{{ data.artwork.viewCount }} views</span>
		<span>{{ data.artwork.likeCount }} likes</span>
		<span>{{ data.artwork.bookmarkCount }} bookmarks</span>
	</div>
	<div class="illust-author">
		<a href="/users/{{ data.user._id }}">
			<img src="{{ data.user.image}}" alt="{{ data.user.name}}"/>
			<span>{{ data.user.name }}</span>
		</a>
	</div>
	<br>
	<div class="illust-tags">
		{% for tag in data.artwork.tags %}
		<div class="tag">
			<a href="/tag/{{ tag.tag }}">
				#{{ tag.tag }}
			</a>
			{% if tag.enTranslation %}
			<i>{{ tag.enTranslation }}</i>
			{% endif %}
		</div>
		{% endfor %}
	</div>
	{% if data.artwork.description %}
	<div class="illust-description">
		<h3>Description</h3>
		<p>
		{{ data.artwork.description|safe }}
		</p>
	</div>
	{% endif %}
</div>

<h2>Related</h2>

{% if g.get('omittedByFilter') %}
<i>Some entries have been hidden due to filters</i>
<br>
<br>
{% endif %}

<div class="container">
	<div class="artwork-container">
		{% for d in data.related %}
		{% include "components/artwork-prev.html" %}
		{% endfor %}
	</div>
</div>

{% endblock %}
