{% extends "settings/settingsMain.html" %}
{% set currentSection = 'account' %}

{% block settingsPage %}

<h2>{{ _("Account Settings") }}</h2>

{% if not g.isAuthorized %}

<h3>{{ _("Log in") }}</h3>
<p>{{ _("Log in to your pixiv account to access features that require an account, such as:") }}</p>

<ul>
	<li>{{ _("Bookmarking/liking posts") }}</li>
	<li>{{ _("Following users") }}</li>
	<li>{{ _("Personalized recommendations and landing page") }}</li>
	{% if config["authless"] %}
	<li>{{ _("Access information that requires an account such as artworks deemed \"sensitive\" by pixiv staff") }}</li>
	{% endif %}
</ul>

<p>{{ _("To log in, you must get your pixiv PHPSESSID cookie. See the guide <a href='https://pixivfe-docs.pages.dev/obtaining-pixivfe-token/' rel='noopener noreferer'>from PixivFE</a> for details. Your token is stored locally and will not be stored on the server.") }}</p>

<p>{{ _("For security purposes, cookies will expire 30 days after the time of logging in") }}</p>

<p>{{ _("<strong>Notice:</strong> By logging in, you agree that the instance will be sending requests on behalf of <strong>your account</strong>.") }}</p>

<form action="/settings/token" class="inline-form" method="POST">
	<input type="password" placeholder="1234567890_aBCdEFgHiJKLmNOpQRsTUvWXYZ" name="token" autocomplete="off" required="true"></input>
	<button type="submit" class="button">{{ _("Log in") }}</button>
</form>

{% else %}
<div class="current-user-account">
	<img alt="{{ g.userState.userName }}" src="{{ g.userState.profileImg }}">
	<div class="user-info">
		<h2>{{ g.userState.userName }}</h2>
		<small>@{{ g.userState.pixivId }}</small>
	</div>
</div>

<br>
<br>

<form action="/settings/logout">
	<button type="submit" class="button danger">{{ _("Log out") }}</button>
</form>

<h2>{{ _("Your pixiv session token") }}</h2>
<p>{{ _("This is your pixiv <code>PHPSESSID</code> cookie, used to authenticate you on pixiv. You can copy this in case you want to switch instances or if you forget it. Hover to reveal.") }}</p>

<pre class="user-account-token"><span>{{request.cookies.get("PyXivSession")}}</span></pre>


{% endif %}
{% endblock %}

